# RemoteConfigService - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ API –∫–ª—é—á–µ–π

## –û–ø–∏—Å–∞–Ω–∏–µ

`RemoteConfigService` - —ç—Ç–æ —Å–µ—Ä–≤–∏—Å –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ API-–∫–ª—é—á–µ–π –∏–∑ Google Sheets. –û–Ω –∑–∞–º–µ–Ω—è–µ—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ API-–∫–ª—é—á–∏ –≤ –∫–æ–¥–µ –Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –∏–∑ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**: API-–∫–ª—é—á –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ Google Sheets CSV
- ‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ö–ª—é—á —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ UserDefaults –¥–ª—è –æ—Ñ–ª–∞–π–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ö–ª—é—á –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑ –≤ 24 —á–∞—Å–∞
- ‚úÖ **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞**: –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```swift
let remoteConfigService = RemoteConfigService()

// –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
remoteConfigService.getAPIKey { apiKey in
    if let apiKey = apiKey {
        print("API –∫–ª—é—á –ø–æ–ª—É—á–µ–Ω: \(apiKey)")
        // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
    } else {
        print("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á")
    }
}
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

```swift
// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ API –∫–ª—é—á–∞
remoteConfigService.refreshAPIKey { success in
    if success {
        print("API –∫–ª—é—á —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω")
    } else {
        print("–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è API –∫–ª—é—á–∞")
    }
}
```

### –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –∫—ç—à)

```swift
// –ü–æ–ª—É—á–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω)
if let apiKey = remoteConfigService.getAPIKeySync() {
    print("–ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –∫–ª—é—á: \(apiKey)")
} else {
    print("–ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω")
}
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

### –î–æ (–∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π –∫–ª—é—á)

```swift
class OpenRouterAPIService {
    private let apiKey = "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"
    
    func makeRequest() {
        request.setValue("Bearer \(apiKey)", forHTTPHeaderField: "Authorization")
    }
}
```

### –ü–æ—Å–ª–µ (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–ª—é—á)

```swift
class OpenRouterAPIService {
    private let remoteConfigService = RemoteConfigService()
    
    func makeRequest() async throws {
        let apiKey = try await getAPIKey()
        request.setValue("Bearer \(apiKey)", forHTTPHeaderField: "Authorization")
    }
    
    private func getAPIKey() async throws -> String {
        return try await withCheckedThrowingContinuation { continuation in
            remoteConfigService.getAPIKey { apiKey in
                if let apiKey = apiKey {
                    continuation.resume(returning: apiKey)
                } else {
                    continuation.resume(throwing: APIError.keyNotFound)
                }
            }
        }
    }
}
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets

### –§–æ—Ä–º–∞—Ç CSV —Ñ–∞–π–ª–∞

CSV —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å—Ç—Ä–æ–∫—É —Å API –∫–ª—é—á–æ–º –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```csv
apiKey,sk-or-v1-your-actual-api-key-here
```

### URL –¥–ª—è Google Sheets

```
https://docs.google.com/spreadsheets/d/e/2PACX-1vT-wvWAbmKGId7oTEFhAUGdUWJt1BrexuREA2XqmDWg8CcjXTt1-KuX7zimYYe7vVc4hlme6F0Rk0FI/pub?gid=0&single=true&output=csv
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RemoteConfigTester

```swift
// –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç
RemoteConfigTester.quickTest()

// –ò–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
let tester = RemoteConfigTester()
tester.runFullTest()
```

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

1. **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫** - –∑–∞–≥—Ä—É–∑–∫–∞ –∫–ª—é—á–∞ –∏–∑ —Å–µ—Ç–∏
2. **–û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞
3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞** - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
4. **–û—à–∏–±–∫–∏ —Å–µ—Ç–∏** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫–ª—é—á –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞. –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞:

```swift
// –í RemoteConfigService.swift
private let updateInterval: TimeInterval = 12 * 60 * 60 // 12 —á–∞—Å–æ–≤
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª—é—á–µ–π UserDefaults

```swift
// –í RemoteConfigService.swift
private let apiKeyKey = "remote_api_key"           // –ö–ª—é—á –¥–ª—è API –∫–ª—é—á–∞
private let lastUpdateKey = "last_api_key_update"  // –ö–ª—é—á –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ API –∫–ª—é—á –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∫–æ–¥–µ
- ‚úÖ –ö–ª—é—á –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ UserDefaults
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–µ—Ä–≤–∏—Å –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

```
üì± RemoteConfigService: –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –∫–ª—é—á
üîÑ RemoteConfigService: –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ API –∫–ª—é—á–∞
üåê RemoteConfigService: –ó–∞–≥—Ä—É–∂–∞–µ–º API –∫–ª—é—á –∏–∑ Google Sheets
‚úÖ RemoteConfigService: API –∫–ª—é—á —É—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω –∏–∑ CSV
üíæ RemoteConfigService: API –∫–ª—é—á —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ UserDefaults
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–°–µ—Ä–≤–∏—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫:

- ‚ùå **–°–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏** - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- ‚ùå **HTTP –æ—à–∏–±–∫–∏** - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞
- ‚ùå **–ü–∞—Ä—Å–∏–Ω–≥ –æ—à–∏–±–∫–∏** - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç CSV
- ‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–ª—é—á–∞** - –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ CSV

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- ‚ö° **–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–µ–Ω –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- ‚ö° **–§–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI
- ‚ö° **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫** - –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- ‚ö° **–û—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç–∞** - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
